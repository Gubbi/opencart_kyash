<?xml version="1.0" encoding="utf-8"?>
<modification>
    <code>v0.2</code>
    <id>opencart_kyash</id>
    <name>Kyash Payment Gateway</name>
    <version>1.0</version>
    <author>Bilent Services Pvt Ltd</author>
    <link>https://www.kyash.com</link>
    <file path="catalog/controller/api/order.php">
        <operation>
            <search index="1,3"><![CDATA[
            $json['success'] = $this->language->get('text_success');
            ]]></search>
            <add position="replace"><![CDATA[
            $json['success'] = $this->language->get('text_success');

            //Begin Kyash
            $this->load->model('payment/kyash');
            $response = $this->model_payment_kyash->update($order_id);
            if(!empty($response)) $json['success'] .= $response;
            //End Kyash
            ]]></add>
        </operation>
    </file>
    <file path="catalog/view/theme/default/template/common/success.tpl">
        <operation>
            <search><![CDATA[
            <?php echo $content_bottom; ?></div>
            ]]></search>
            <add position="replace"><![CDATA[
            <!-- Begin Kyash -->
            <?php if(isset($kyash_content)) { echo $kyash_content; } ?>
            <!-- End Kyash -->
            <?php echo $content_bottom; ?></div>
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/checkout/success.php">
        <operation>
            <search><![CDATA[
            if (file_exists(DIR_TEMPLATE . $this->config->get('config_template') . '/template/common/success.tpl')) {
            ]]></search>
            <add position="replace"><![CDATA[
            //Begin Kyash
            $this->load->model('payment/kyash');
            $data['kyash_content'] = $this->model_payment_kyash->getSuccessContent($this->request->get['order_id']);
            //End Kyash

            if (file_exists(DIR_TEMPLATE . $this->config->get('config_template') . '/template/common/success.tpl')) {
            ]]></add>
        </operation>
    </file>
</modification>